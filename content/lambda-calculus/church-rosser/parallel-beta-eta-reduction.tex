% Part: lambda-calculus
% Chapter: church-rosser
% Section: parallel-beta-eta-reduction

\documentclass[../../../include/open-logic-section]{subfiles}

\begin{document}

\olfileid{lc}{cr}{pbe}

\olsection{Parallel $\beta\eta$-reduction}

In this section we will prove the Church-Rosser property of parallel
$\beta\eta$-reduction, which is basically $\beta$-reduction plus
$\eta$. Since most things are copy-and-paste, we have omitted some
duplicated definitions and proofs here.

\begin{defn}[Parallel $\beta\eta$-reduction, $\beredpar$] \ollabel{def}
  \emph{Parallel $\beta\eta$-reduction} ($\beredpar$) on terms is inductively defined as follows:
  \begin{enumerate}
    \item The first four cases are exactly those from \olref[pb]{def}.
    \item \ollabel{def:5} If $N \beredpar N'$ then $\lambd[x][Nx]
      \beredpar N'$, provided $x \notin FV(N)$.
  \end{enumerate}
\end{defn}

\begin{thm}\ollabel{thm:refl}
  $M \beredpar M$.
\end{thm}
\begin{proof}
  Just like what we did in \olref[pb]{thm:refl}.
\end{proof}

\begin{defn}[$\beta\eta$-complete development]\ollabel{cd}
  The \emph{$\beta\eta$-complete development} of $M$, or $\becd{M}$, is defined
  as follows:
  \begin{align}
    \becd{x} &= x \ollabel{cd:1} \\
    \becd{(\lambd[x][N])} &= \lambd[x][\becd{N}] \ollabel{cd:2}\\
    \becd{(PQ)} &= \becd{P}\becd{Q} && \text{if $P$ is not abstraction} \ollabel{cd:3} \\
    \becd{((\lambd[x][N])Q)} &= \Subst{\becd{N}}{\becd{Q}}{x}
                             \ollabel{cd:4} \\
    \becd{(\lambd[x][Nx])} &= \becd{N} \ollabel{cd:5} & \text{if $x
                                                      \notin FV(N)$}
  \end{align}
\end{defn}

\begin{lem}\ollabel{lem:comp}
  If $M \beredpar M'$ and $R \beredpar R'$, then $\Subst{M}{R}{y}
  \beredpar \Subst{M'}{R'}{y}$.
\end{lem}
\begin{proof}
  By induction on the derivation of $M \beredpar M'$.
  \begin{enumerate}
    \item The first four cases are exactly like those in
      \olref[pb]{lem:comp}.
    \item If the last rule is \olref{def:5}, then $M$ is
      $\lambd[x][Nx]$, $M'$ is $N'$ for some $x, N'$ where $x \notin
      FV(N)$ and $N \beredpar N'$. We want
      $\Subst{(\lambd[x][Nx])}{R}{y} \beredpar \Subst{N'}{R'}{y}$,
      which is $\lambd[x][\Subst{N}{R}{y} x] \beredpar
      \Subst{N'}[R']{y}$, which we can get by \olref{def:5} with
      inductive hypothesis.
  \end{enumerate}
\end{proof}

\begin{lem}\ollabel{lem:cont}
  If $M \beredpar M'$ then $M' \beredpar \becd{M}$.
\end{lem}
\begin{proof}
  By induction on the derivation of $M \beredpar M'$.
  \begin{enumerate}
    \item The first four cases are those in \olref[pb]{lem:cont}.
    \item If the last rule is \olref{def:5}, then $M$ is
      $\lambd[x][Nx]$ and $M'$ is $N'$ for some $x,N,N'$ where $x
      \notin FV(N)$ and $N \beredpar N'$. We want $N' \beredpar
      \becd{(\lambd[x][Nx])}$, which is $N' \beredpar \becd{N}$, which
      is immediate by inductive hypothesis.
  \end{enumerate}
\end{proof}

\begin{thm}\ollabel{thm:cr}
  $\beredpar$ has Church-Rosser property.
\end{thm}
\begin{proof}
  Immediate from \olref{lem:cont}.
\end{proof}
\end{document}

