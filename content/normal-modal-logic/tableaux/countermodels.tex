% Part: normal-modal-logic
% Chapter: tableaux
% Section: countermodels

\documentclass[../../../include/open-logic-section]{subfiles}

\begin{document}

\olfileid{nml}{tab}{cou}
      
\olsection{Countermodels from \usetoken{P}{tableau}}

\begin{explain}
  The proof of the completeness theorem doesn't just show that if
  $\Entails !A$ then $\Proves !A$, it also gives us a method for
  constructing countermodels to~$!A$ if $\Entails/ A$. In the case
  of~$\Log{K}$, this method constitutes a \emph{decision
    procedure}. For suppose $\Entails/ !A$. Then the proof of
  \olref[cpl]{prop:complete-tableau} gives a method for constructing a
  complete !!{tableau}. The method in fact always terminates. The
  propositional rules for~$\Log{K}$ only add prefixed !!{formula}s of
  lower complexity, i.e., each propositional rule need only be applied
  once on a branch for any signed formula $\sFmla{S}{!A}[\sigma]$. New
  prefixes are only generated by the
  \iftag{prvBox}{$\TRule{\False}{\Box}$}{}\iftag{notprvBox,notprvDiamond}{}{
    and }\iftag{prvDiamond}{$\TRule{\True}{\Diamond}$}{}
  \iftag{notprvBox,notprvDiamond}{rule}{rules}, and also only have to
  be applied once (and produce a single new prefix).
  \iftag{prvBox}{$\TRule{\True}{\Box}$}{}\iftag{notprvBox,notprvDiamond}{}{
    and }\iftag{prvDiamond}{$\TRule{\False}{\Diamond}$}{}
  \iftag{notprvBox,notprvDiamond}{has}{have} to be applied potentially
  multiple times, but only once per prefix, and only finitely many new
  prefixes are generated. So the construction either results in a
  closed branch or a complete branch after finitely many stages.

  Once a tableau with an open complete branch is constructed, the
  proof of \olref[cpl]{thm:tableau-completeness} gives us an explict model
  that satisfies the original set of prefixed !!{formula}s. So not
  only is it the case that if $\Gamma \Entails !A$, then a closed
  !!{tableau} exists and $\Gamma \Proves !A$, if we look for the
  closed !!{tableau} in the right way and end up with a ``complete''
  !!{tableau}, we'll not only know that $\Gamma \Entails/ !A$ but
  actually be able to construct a countermodel.
\end{explain}

\iftag{prvBox}{
\begin{ex}
  We know that $\Proves/ \Box(p \lor q) \lif (\Box p \lor \Box
  q)$. The construction of a tableau begins with:
  \begin{oltableau}
    [\pFmla{\False}{\Box(p \lor q) \lif (\Box p \lor \Box q)}{1},
      just = \TAss, checked
      [\pFmla{\True}{\Box(p \lor q)}{1},
        just = {\TRule{\False}{\lif}[1]}, 
        [\pFmla{\False}{\Box p \lor \Box q}{1},
          just = {\TRule{\False}{\lif}[1]}, checked
          [\pFmla{\False}{\Box p}{1},
            just = {\TRule{\False}{\lor}[3]}, checked
            [\pFmla{\False}{\Box q}{1},
              just = {\TRule{\False}{\lor}[3]}, checked
              [\pFmla{\False}{p}{1.1}, 
                just = {\TRule{\False}{\Box}[4]}, checked
                [\pFmla{\False}{q}{1.2}, 
                  just = {\TRule{\False}{\Box}[5]}, checked
                ]
              ]
            ]
          ]
        ]
      ]
    ]
  \end{oltableau}
  The !!{tableau} is of course not finished yet. In the next step, we
  consider the only line without a checkmark: the prefixed !!{formula}
  $\sFmla{\True}{\Box(p \lor q)}[1]$ on line~$2$. The construction of
  the closed tableau says to apply the $\TRule{\True}{\Box}$ rule for
  every prefix used on the branch, i.e., for both $1.1$ and $1.2$:
  \begin{oltableau}
    [\pFmla{\False}{\Box(p \lor q) \lif (\Box p \lor \Box q)}{1},
      just = \TAss, checked
      [\pFmla{\True}{\Box(p \lor q)}{1},
        just = {\TRule{\False}{\lif}[1]}, 
        [\pFmla{\False}{\Box p \lor \Box q}{1},
          just = {\TRule{\False}{\lif}[1]}, checked
          [\pFmla{\False}{\Box p}{1},
            just = {\TRule{\False}{\lor}[3]}, checked
            [\pFmla{\False}{\Box q}{1},
              just = {\TRule{\False}{\lor}[3]}, checked
              [\pFmla{\False}{p}{1.1}, 
                just = {\TRule{\False}{\Box}[4]}, checked
                [\pFmla{\False}{q}{1.2}, 
                  just = {\TRule{\False}{\Box}[5]}, checked
                  [\pFmla{\True}{p \lor q}{1.1}, 
                    just = {\TRule{\True}{\Box}[2]}
                    [\pFmla{\True}{p \lor q}{1.2}, 
                      just = {\TRule{\True}{\Box}[2]}
                    ]
                  ]
                ]
              ]
            ]
          ]
        ]
      ]
    ]
  \end{oltableau}
  Now lines 2, 8, and 9, don't have checkmarks. But no new prefix has
  been added, so we apply $\TRule{\True}{\lor}$ to lines~8 and~9, on
  all resulting branches (as long as they don't close):
  \begin{oltableau}
    [\pFmla{\False}{\Box(p \lor q) \lif (\Box p \lor \Box q)}{1},
      just = \TAss, checked
      [\pFmla{\True}{\Box(p \lor q)}{1},
        just = {\TRule{\False}{\lif}[1]}, 
        [\pFmla{\False}{\Box p \lor \Box q}{1},
          just = {\TRule{\False}{\lif}[1]}, checked
          [\pFmla{\False}{\Box p}{1},
            just = {\TRule{\False}{\lor}[3]}, checked
            [\pFmla{\False}{\Box q}{1},
              just = {\TRule{\False}{\lor}[3]}, checked
              [\pFmla{\False}{p}{1.1}, 
                just = {\TRule{\False}{\Box}[4]}, checked
                [\pFmla{\False}{q}{1.2}, 
                  just = {\TRule{\False}{\Box}[5]}, checked
                  [\pFmla{\True}{p \lor q}{1.1}, 
                    just = {\TRule{\True}{\Box}[2]}, checked
                    [\pFmla{\True}{p \lor q}{1.2}, 
                      just = {\TRule{\True}{\Box}[2]}, checked
                      [\pFmla{\True}{p}{1.1},
                        just = {\TRule{\True}{\lor}[8]}, checked, close
                      ]
                      [\pFmla{\True}{q}{1.1},
                        just = {\TRule{\True}{\lor}[8]}, checked
                        [\pFmla{\True}{p}{1.2},
                          just = {\TRule{\True}{\lor}[9]}, checked]
                        [\pFmla{\True}{q}{1.2},
                          just = {\TRule{\True}{\lor}[9]}, checked, close]
                      ]
                    ]
                  ]
                ]
              ]
            ]
          ]
        ]
      ]
    ]
  \end{oltableau}
  There is one remaining open branch, and it is complete. From it we
  define the model with worlds $W = \{1, 1.1, 1.2\}$ (the only
  prefixes appearing on the open branch), the accessibility relation
  $R = \{\tuple{1, 1.1}, \tuple{1, 1.2}\}$, and the assignment $V(p) =
  \{1.2\}$ (because line~11 contains $\sFmla{\True}{p}[1.2]$) and
  $V(q) = \{1.1\}$ (because line~10 contains
  $\sFmla{\True}{q}[1.1]$). The model is pictured in
  \olref{fig:counter-Box}, and you can verify that it is a
  countermodel to $\Box(p \lor q) \lif (\Box p \lor \Box q)$.
  \begin{figure}
  \begin{center}
    \begin{tikzpicture}[modal]
      \node[world] (w1) [label={[align=right]right:\mFalse{p}\\ \mFalse{q}}]{$1$}; 
      \node[world] (w2) [label={[align=right]right:\mFalse{p}\\ \mTrue{q}},
        above left=of w1]{$1.1$}; 
      \node[world] (w3) [label={[align=right]right:\mTrue{p}\\ \mFalse{q}},
        above right=of w1] {$1.2$};
      \draw[->] (w1) to (w2);
      \draw[->] (w1) to (w3);
    \end{tikzpicture}
  \end{center}
  \caption{A countermodel to $\Box(p \lor q) \lif (\Box p \lor \Box
    q)$.}
  \ollabel{fig:counter-Box}
\end{figure}
\end{ex}          
}
{
\begin{ex}
  We know that $\Proves/ (\Diamond p \land \Diamond q) \lif \Diamond(p
  \land q)$. The construction of a tableau begins with:
  \begin{oltableau}
    [\pFmla{\False}{(\Diamond p \land \Diamond q) \lif \Diamond(p \land q)}{1},
      just = \TAss, checked
      [\pFmla{\True}{\Diamond p \land \Diamond q}{1},
        just = {\TRule{\False}{\lif}[1]}, checked
        [\pFmla{\False}{\Diamond(p \land q)}{1},
          just = {\TRule{\False}{\lif}[1]}
          [\pFmla{\True}{\Diamond p}{1},
            just = {\TRule{\True}{\land}[2]}, checked
            [\pFmla{\True}{\Diamond q}{1},
              just = {\TRule{\True}{\land}[2]}, checked
              [\pFmla{\True}{p}{1.1}, 
                just = {\TRule{\True}{\Diamond}[4]}, checked
                [\pFmla{\True}{q}{1.2}, 
                  just = {\TRule{\True}{\Diamond}[5]}, checked
                ]
              ]
            ]
          ]
        ]
      ]
    ]
  \end{oltableau}
  The !!{tableau} is of course not finished yet. In the next step, we
  consider the only line without a checkmark: the prefixed !!{formula}
  $\sFmla{\True}{\Diamond(p \land q)}[1]$ on line~$3$. The construction of
  the closed tableau says to apply the $\TRule{\True}{\Diamond}$ rule for
  every prefix used on the branch, i.e., for both $1.1$ and $1.2$:
  \begin{oltableau}
    [\pFmla{\False}{\Diamond(p \land q) \lif (\Diamond p \land \Diamond q)}{1},
      just = \TAss, checked
      [\pFmla{\True}{\Diamond p \land \Diamond q}{1},
        just = {\TRule{\False}{\lif}[1]}, checked
        [\pFmla{\False}{\Diamond (p \land q)}{1},
          just = {\TRule{\False}{\lif}[1]}
          [\pFmla{\True}{\Diamond p}{1},
            just = {\TRule{\True}{\land}[2]}, checked
            [\pFmla{\True}{\Diamond q}{1},
              just = {\TRule{\True}{\land}[2]}, checked
              [\pFmla{\True}{p}{1.1}, 
                just = {\TRule{\True}{\Diamond}[4]}, checked
                [\pFmla{\True}{q}{1.2}, 
                  just = {\TRule{\True}{\Diamond}[5]}, checked
                  [\pFmla{\False}{p \land q}{1.1}, 
                    just = {\TRule{\False}{\Diamond}[3]}
                    [\pFmla{\False}{p \land q}{1.2}, 
                      just = {\TRule{\False}{\Diamond}[3]}
                    ]
                  ]
                ]
              ]
            ]
          ]
        ]
      ]
    ]
  \end{oltableau}
  Now lines 3, 8, and 9, don't have checkmarks. But no new prefix has
  been added, so we apply $\TRule{\False}{\land}$ to lines~8 and~9, on
  all resulting branches (as long as they don't close):
  \begin{oltableau}
    [\pFmla{\False}{(\Diamond p \land \Diamond q) \lif \Diamond(p \land q)}{1},
      just = \TAss, checked
      [\pFmla{\True}{\Diamond p \land \Diamond q}{1},
        just = {\TRule{\False}{\lif}[1]}, checked
        [\pFmla{\False}{\Diamond(p \land q)}{1},
          just = {\TRule{\False}{\lif}[1]}
          [\pFmla{\True}{\Diamond p}{1},
            just = {\TRule{\True}{\land}[2]}, checked
            [\pFmla{\True}{\Diamond q}{1},
              just = {\TRule{\True}{\land}[2]}, checked
              [\pFmla{\True}{p}{1.1}, 
                just = {\TRule{\True}{\Diamond}[4]}, checked
                [\pFmla{\True}{q}{1.2}, 
                  just = {\TRule{\True}{\Diamond}[5]}, checked
                  [\pFmla{\False}{p \land q}{1.1}, 
                    just = {\TRule{\False}{\Diamond}[3]}, checked
                    [\pFmla{\False}{p \land q}{1.2}, 
                      just = {\TRule{\False}{\Diamond}[3]}, checked
                      [\pFmla{\False}{p}{1.1},
                        just = {\TRule{\False}{\land}[8]}, checked, close
                      ]
                      [\pFmla{\False}{q}{1.1},
                        just = {\TRule{\False}{\land}[8]}, checked
                        [\pFmla{\False}{p}{1.2},
                          just = {\TRule{\False}{\land}[9]}, checked]
                        [\pFmla{\False}{q}{1.2},
                          just = {\TRule{\False}{\land}[9]}, checked, close]
                      ]
                    ]
                  ]
                ]
              ]
            ]
          ]
        ]
      ]
    ]
  \end{oltableau}
  There is one remaining open branch, and it is complete. From it we
  define the model with worlds $W = \{1, 1.1, 1.2\}$ (the only
  prefixes appearing on the open branch), the accessibility relation
  $R = \{\tuple{1, 1.1}, \tuple{1, 1.2}\}$, and the assignment $V(p) =
  \{1.1\}$ (because line~6 contains $\sFmla{\True}{p}[1.1]$) and
  $V(q) = \{1.2\}$ (because line~7 contains
  $\sFmla{\True}{q}[1.1]$). The model is pictured in
  \olref{fig:counter-Diamond}, and you can verify that it is a
  countermodel to $(\Diamond p \land \Diamond q) \lif \Diamond (p \land q)$.
  \begin{figure}
  \begin{center}
    \begin{tikzpicture}[modal]
      \node[world] (w1) [label={[align=right]right:\mFalse{p}\\ \mFalse{q}}]{$1$}; 
      \node[world] (w2) [label={[align=right]right:\mTrue{p}\\ \mFalse{q}},
        above left=of w1]{$1.1$}; 
      \node[world] (w3) [label={[align=right]right:\mFalse{p}\\ \mTrue{q}},
        above right=of w1] {$1.2$};
      \draw[->] (w1) to (w2);
      \draw[->] (w1) to (w3);
    \end{tikzpicture}
  \end{center}
  \caption{A countermodel to $(\Diamond p \land \Diamond q) \lif
    \Diamond (p \land q)$.}
  \ollabel{fig:counter-Diamond}
\end{figure}
\end{ex}          
}

\end{document}
