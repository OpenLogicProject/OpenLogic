% Part: first-order-logic
% Chapter: syntax-and-semantics
% Section: satisfaction

\documentclass[open-logic-section]{subfiles}

\begin{document}

\section{Satisfaction of a Formula in a Structure}

\begin{wordy}
The basic notion that relates expressions such as terms and formulas,
on the one hand, and structures on the other, are those of
\emph{denotation} and \emph{satisfaction}.  Informally, a term
\emph{denotes} an element of a structure---if the term is just a
constant, it denotes the object assigned to the constant by the
structure, and if it is built up using function symbols, the
denotation is computed from the values of constants and the functions
assigned to the functions in the term.  A formula is \emph{satisfied}
in a structure if the interpretation given to the predicates makes the
formula true in the domain of the structure. This notion of
satisfaction is specified inductively: the specification of the
structure directly states when atomic formulas are satisfied, and we
define when a complex formula is satisfied depending on the main
connective or quantifier and whether or not the immediate subformulas
are satisfied. The case of the quantifiers here is a bit tricky, as
the immediate subformula of a quantified formula has a free variable,
and structures don't specify what variables denote.  In order to deal
with this difficulty, we also introduce \emph{variable assignments}
and define satisfaction not with respect to a structure alone, but
with respect to a structure plus a variable assignment.
\end{wordy}

\begin{defn}[Variable Assignment]
A \emph{variable assignment}~$s$ for a structure~$\Struct{M}$ is a
function which maps each variable to an element of~$\Domain M$, i.e.,
$s\colon \Var \to \Domain M$.
\end{defn}

\begin{defn}[Denotation of terms]
If $t$ is a term of the language~$\Lang L$, $\Struct M$ is a structure
for~$\Lang L$, and $s$ is a variable assignment for~$\Struct M$, the
\emph{denotation}~$\Value{t}{M}[s]$ is defined as follows:
\begin{enumerate}
\item If $t$ is just the constant $c$, then $\Value{c}{M}[s] = \Assign{c}{M}$.
\item If $t$ is just the variable~$x$, then $\Value{c}{M}[s] = s(x)$.
\item If $t$ is of the form $\Atom{f}{t_1, \ldots, t_n}$, then
\[
\Value{t}{M}[s] = \Assign{f}{M}(\Value{t_1}{M}[s], \ldots,
\Value{t_n}{M}[s]).
\]
\end{enumerate}
\end{defn}

\begin{defn}[$x$-Variant]
If $s$ is a variable assignment for a structure~$\Struct M$, then any
variable assignment $s'$ for $\Struct M$ which differs from $s$ only
in what it assigns to $x$ is called an \emph{$x$-variant} of~$s$.  If
$s'$ is an $x$-variant of $s$ we write $s \sim_x s'$.
\end{defn}

\begin{defn}[Satisfaction]
Satisfaction of a formula~$!A$ in a structure~$\Struct M$ relative to
a variable assignment~$s$, $\Sat{M}{!A}[s]$ is defined inductively as
follows. If not $\Sat{M}{!A}[s]$ we write $\Sat/{M}{!A}[s]$.
\begin{enumerate}
\item Never $\Sat{M}{\lfalse}[s]$.
\item Always $\Sat{M}{\ltrue}[s]$.
\item For any $n$-place predicate~$R$ and terms $t_1$, \dots, $t_n$,
  $\Sat{M}{\Atom{R}{t_1, \dots, t_n}}[s]$ iff $\langle \Value{t_1}{M}[s],
  \dots, \Value{t_n}{M}[s] \rangle \in \Assign{R}{M}$.
\item For any terms $t$, $t'$, $\Sat{M}{\leq[t_1][t_2]}[s]$ iff
  $\Value{t}{M}[s] = \Value{t'}{M}[s]$.
\item $\Sat{M}{\lnot !A}[s]$ iff $\Sat/{M}{!A}[s]$
\item $\Sat{M}{!A \land !B}[s]$ iff $\Sat{M}{!A}[s]$ and $\Sat{M}{!B}[s]$.
\item $\Sat{M}{!A \lor !B}[s]$ iff $\Sat{M}{!A}[s]$ or
  $\Sat{M}{!B}[s]$ (or both).
\item $\Sat{M}{!A \lif !B}[s]$ iff $\Sat/{M}{!A}[s]$ or
  $\Sat{M}{!B}[s]$ (or both).
\item $\Sat{M}{\lexists[x][!A]}[s]$ iff there is an $x$-variant $s'$
  of $s$ so that $\Sat{M}{!A}[s']$.
\item $\Sat{M}{\lforall[x][!A]}[s]$ iff for every $x$-variant $s'$ of
  $s$, $\Sat{M}{!A}[s']$.
\end{enumerate}
\end{defn}

\begin{wordy}
A variable assignment~$s$ provide a value for \emph{every} variable in
the language. This is of course not necessary: whether or not a
formula~$!A$ is satisfied in a structure with respect to~$s$ only
depends on the assignments~$s$ makes to the free variables that
actually occur in~$!A$.  This is the content of the next theorem.  We
require variable assignments to assign values to all variables simply
because it makes things a lot easier.
\end{wordy}

\begin{prop}
If $x_1$, \dots, $x_n$ are the only free variables in $!A$ and $s(x_i)
= s'(x_i)$ for $i = 1$, \dots, $n$, then $\Sat{M}{!A}[s]$ iff
$\Sat{M}{!A}[s']$.
\end{prop}

\begin{proof}

Prove by induction on the complexity of $!A$. For the base case, where
$!A$ is atomic, $!A$ can be: $\ltrue$, $\lfalse$, $R(t_1 \ldots t_k)$
for a $k$-place predicate $R$ and terms $t_1,\ldots,t_k$, or
$\leq[t_1][t_2]$ for terms $t_1$ and $t_2$.

When $!A$ is $\ltrue$, since $\ltrue$ is valid, both $\Sat{M}{!A}[s]$
and $\Sat{M}{!A}[s']$. Similarly, when $!A$ is $\lfalse$, both
$\Sat!{M}{!A}[s]$ and $\Sat!{M}{!A}[s']$.

For the case when $!A$ is $\Atom{R}{t_1, \ldots, t_k}$, let
$\Sat{M}{!A}[s]$. Then $\langle \Value{t_1}{M}[s], \ldots,
\Value{t_k}{M}[s] \rangle \in \Assign{R}{M}$. For $1 \leq i \leq k$,
if $t_i$ is a constant, then $\Value{t_i}{M}[s] = \Value{t_i}{M} =
\Value{t_i}{M}[s']$. If $t_i$ is a free variable, then since the
mappings $s$ and $s'$ agree on all free variables, $\Value{t_i}{M}[s]
= s(t_i) = s'(t_i) = \Value{t_i}{M}[s']$. Similarly, if $t_i$ is of
the form $f(t'_1,\ldots,t'_j)$, we will also get $\Value{t_i}{M}[s] =
\Value{t_i}{M}[s']$. Hence, $\Value{t_i}{M}[s] = \Value{t_i}{M}[s']$
for any term $t_i$ for $1 \leq i \leq k$, so we also have $\langle
\Value{t_i}{M}[s'], \ldots, \Value{t_k}{M}[s'] \rangle \in
\Assign{R}{M}$. Similarly, when $!A$ is $\leq[t_1][t_2]$, and when
$\Sat{M}{\leq[t_1][t_2]}[s]$, $\Value{t_1}{M}[s'] = \Value{t_1}{M}[s] =
\Value{t_2}{M}[s] = \Value{t_2}{M}[s']$, so $\Sat{M}{\leq[t_1][t_2]}[s']$.

Let $\Sat{M}{!B}[s] \Leftrightarrow \Sat{M}{!B}[s']$ for all formulae
$!B$ and $!C$ that are less complex than $!A$. The induction step
proceeds in cases determined by the main connective of $!A$. In each
case, only the forward direction of the biconditional is demonstrated
since the proof of the reverse direction is symmetrical.

If $!A$ is $\lnot !B$ and $\Sat{M}{\lnot !B}[s]$, then
$\Sat!{M}{!B}[s]$, so by the induction hypothesis, $\Sat!{M}{!B}[s']$,
hence $\Sat{M}{\lnot !B}[s']$.

If $!A$ is $!B \land !C$ and $\Sat{M}{!B \land !C}[s]$, then
$\Sat{M}{!B}[s]$ and $\Sat{M}{!C}[s]$, so by the induction hypothesis,
$\Sat{M}{!B}[s']$ and $\Sat{M}{!C}[s']$. Hence, $\Sat{M}{!B \land
  !C}[s']$.

If $!A$ is $!B \lor !C$ and $\Sat{M}{!B \lor !C}[s]$, then
$\Sat{M}{!B}[s]$ or $\Sat{M}{!C}[s]$. By the induction hypothesis,
$\Sat{M}{!B}[s']$ or $\Sat{M}{!C}[s']$, so $\Sat{M}{!B \lor !C}[s']$.

If $!A$ is $!B \lif !C$ and $\Sat{M}{!B \lif !C}[s]$, then
$\Sat!{M}{!B}[s]$ or $\Sat{M}{!C}[s]$. By the induction hypothesis,
$\Sat!{M}{!B}[s']$ or $\Sat{M}{!C}[s']$, so $\Sat{M}{!B \lif !C}[s']$.

If $!A$ is $\lexists[x][!B]$ and $\Sat{M}{\lexists[x][!B]}[s]$, there
is an $x$-variant $\bar{s}$ of $s$ so that $\Sat{M}{!B}[\bar{s}]$. Let
$\bar{s}'$ denote the $x$-variant of $s'$ that assigns the same thing
to $x$ as does $\bar{s}$: then by the induction hypothesis,
$\Sat{M}{!B}[\bar{s}']$. Hence, there is an $x$-variant of $s'$ that
satisfies $!B$, so $\Sat{M}{\lexists[x][!B]}[s']$.

If $!A$ is $\lforall[x][!B]$ and $\Sat{M}{\lforall[x][!B]}[s]$, then
for every $x$-variant $\bar{s}$ of $s$, $\Sat{M}{!B}[\bar{s}]$. Hence,
if $\bar{s}'$ is the $x$-variant of $s'$ that assigns the same thing
to $x$ as does $\bar{s}$, then we have $\Sat{M}{!B}[\bar{s}']$. Hence,
every $x$-variant of $s'$ satisfies $!B$, so
$\Sat{M}{\lforall[x][!B]}[s']$.

By induction, we get that $\Sat{M}{!A}[s]$ iff $\Sat{M}{!A}[s']$
whenever $x_1$, \dots, $x_n$ are the only free variables in $!A$ and
$s(x_i)=s'(x_i)$ for $i=1$, \dots,~$n$.
\end{proof}
 
\begin{defn}
If $!A$ is a sentence, we say that a structure~$\Struct M$
satisfies~$!A$, $\Sat{M}{!A}$, iff $\Sat{M}{!A}[s]$ for all variable
assignments~$s$.
\end{defn}

\begin{prob}
Show that if $!A$ is a sentence, $\Sat{M}{!A}$ iff there is a variable
assignment~$s$ so that $\Sat{M}{!A}[s]$.
\end{prob}

\end{document}
