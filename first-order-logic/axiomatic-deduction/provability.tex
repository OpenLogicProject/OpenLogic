% Part: first-order-logic
% Chapter: axiomatic-deduction
% Section: provability

% verification of properties of provability needed for maximally
% consistent sets in the completeness chapter.

\documentclass[../../include/open-logic-section]{subfiles}

\begin{document}

\olfileid{fol}{axd}{prv}
\olsection{Properties of \usetoken{S}{derivability}}

\begin{prop}[Monotony]
 if $\Gamma \subseteq \Delta$ and $\Gamma
    \Proves !A$ then also $\Delta \Proves
    !A$
\end{prop}

\begin{proof}
Any finite $\Gamma_0 \subseteq \Gamma$ is also a finite subset
of~$\Delta$, so !!a{derivation} of $\Gamma_0 \Proves !A$ also shows
$\Delta \Proves !A$.
\end{proof}

\begin{prop}\ollabel{prop:provability}
  $\Gamma \Proves!A$ if and only if $\Gamma\cup \{\lnot!A \}$
  is inconsistent.
\end{prop}

%%Taken as reminder from the Sequent Calculus Chapter - will update when done
\begin{prop}
\begin{enumerate}

\item \ollabel{prop:provability-contr} If $\Gamma \Proves
  !A$ and $\Gamma \cup \{ !A\} \Proves \lfalse$, then
  $\Gamma$ is inconsistent.

\item \ollabel{prop:provability-lnot} If $\Gamma \cup \{!A\}
  \Proves[\Log{LK}] \lfalse$, then $\Gamma \Proves[\Log{LK}] \lnot !A$.

\item \ollabel{prop:provability-exhaustive} If $\Gamma \cup \{!A\}
  \Proves[\Log{LK}] \lfalse$ and $\Gamma \cup \{\lnot !A\}
  \Proves[\Log{LK}] \lfalse$, then $\Gamma \Proves[\Log{LK}] \lfalse$.

\tagitem{prvOr}{\ollabel{prop:provability-lor-left} If $\Gamma \cup
  \{!A\} \Proves[\Log{LK}] \lfalse$ and $\Gamma \cup \{!B\}
  \Proves[\Log{LK}] \lfalse$, then $\Gamma \cup \{!A \lor !B\}
  \Proves[\Log{LK}] \lfalse$.}{}

\tagitem{prvOr}{\ollabel{prop:provability-lor-right} If $\Gamma
  \Proves[\Log{LK}] !A$ or $\Gamma \Proves[\Log{LK}] !B$,
      then $\Gamma \Proves[\Log{LK}] !A \lor !B$.}{}

\tagitem{prvAnd}{\ollabel{prop:provability-land-left} If $\Gamma
  \Proves[\Log{LK}] !A \land !B$ then $\Gamma \Proves[\Log{LK}] !A$
  and $\Gamma \Proves[\Log{LK}] !B$.}{}

\tagitem{prvAnd}{\ollabel{prop:provability-land-right} If $\Gamma
  \Proves[\Log{LK}] !A$ and $\Gamma \Proves[\Log{LK}] !B$,
 then $\Gamma \Proves[\Log{LK}] !A \land !B$.}{}

\tagitem{prvIf}{\ollabel{prop:provability-mp} If $\Gamma \Proves[\Log{LK}] !A$
  and $\Gamma \Proves[\Log{LK}] !A \lif !B$, then $\Gamma
  \Proves[\Log{LK}] !B$.}{}

\tagitem{prvIf}{\ollabel{prop:provability-lif} If $\Gamma \Proves[\Log{LK}]
  \lnot !A$ or $\Gamma \Proves[\Log{LK}] !B$, then $\Gamma
  \Proves[\Log{LK}] !A \lif !B$.}{}
\end{enumerate}
\end{prop}

\begin{proof}
\begin{enumerate}

\item Consider the following !!{derivation}:

\begin{tabular}{rll}
1. & $\Gamma_0 \cup \{!A\} \Proves \lfalse$ & hyp. \\
2. & $\Gamma_1 \Proves !A$ & hyp.\\
3. & $\Gamma_0 \cup \Gamma_1 \Proves \lfalse$ & cut \\
\end{tabular}

Since $\Gamma_0 \subseteq \Gamma$ and $\Gamma_1 \subseteq \Gamma$,
$\Gamma_0 \cup \Gamma_1 \subseteq \Gamma$, hence $\Gamma
\Proves \lfalse$.

\item Consider the following derivation:
 
\begin{tabular}{rll}
1. & $\Gamma_0 \cup\{\lnot !A\} \Proves \lfalse$ & hyp. \\
2. & $\Gamma_0 \Proves \lnot \lnot !A$ & Prop \olref[fol][axd][rul]{prop:consistent:3}\\
3. & $\lnot \lnot !A \Proves !A$ & Double Negation \\
4. & $\Gamma_0 \Proves !A$ & MP 2, 3 \\
\end{tabular}

\item Consider the following derivation:

 \begin{tabular}{rll}
1. & $\Gamma_0 \cup\{!A\} \Proves \lfalse$ & hyp. \\
2. & $\Gamma_1 \cup \{\lnot !A \} \Proves \lfalse$ & hyp\\
3. & $\Gamma_0 \Proves \lnot !A$ & Prop \olref[fol][axd][rul]{prop:consistent:3} \\
4. & $\Gamma_0 \cup \Gamma_1 \Proves \lfalse$ & Cut 2, 3 \\
\end{tabular}

Since $\Gamma_0 \subseteq \Gamma$ and $\Gamma_1 \subseteq \Gamma$,
$\Gamma_0 \cup \Gamma_1 \subseteq \Gamma$. Hence $\Gamma
\Proves \lfalse$.

% prop:provability-lor-left
\tagitem{defOr}{}{
\iftag{probOr}{Exercise.}{}}


% prop:provability-lor-right
\tagitem{defOr}{}{
\iftag{probOr}{Exercise.}{

 \begin{tabular}{rll}
1. & $\Gamma_0 \Proves !A$ & hyp \\
2. & $!A \lif (!A \lor !B)$ & Ax0\\
3. & $\Gamma_0 \Proves !A \lor !B$ & MP 1, 2 \\
\end{tabular}

Therefore $\Gamma \Proves !A \lor !B$. The proof for when $\Gamma
\Proves !B$ is similar.}}

% prop:provability-land-left
\tagitem{defAnd}{}{
\iftag{probAnd}{Exercise}{

 \begin{tabular}{rll}
1. & $\Gamma_0 \Proves !A \land !B$ & hyp \\
2. & $(!A \land !B) \lif !A $ & Ax0\\
3. & $\Gamma_0 \Proves !A \lor !B$ & MP 1, 2 \\
\end{tabular}

Hence, $\Gamma \Proves !A$. A similar !!{derivation} starting
 shows that $\Gamma \Proves !B$.}}

% prop:provability-land-right
\tagitem{defAnd}{}{\iftag{probAnd}{Exercise.}{}}

% prop:provability-mp
\tagitem{defIf}{}{
\iftag{probIf}{Exercise.}{

 \begin{tabular}{rll}
1. & $\Gamma_0 \Proves !A$ & hyp \\
2. & $\Gamma_0 \Proves !A \lif !B $ & hyp\\
3. & $\Gamma_0 \Proves !B$ & MP 1, 2\\
\end{tabular}

Since $\Gamma_0 \cup \Gamma_1 \subseteq \Gamma$, this
means that $\Gamma \Proves[\Log{LK}] !B$.}}

% prop:provability-lif
\tagitem{defIf}{}{\iftag{probIf}{Exercise.}{First suppose $\Gamma
    \Proves \lnot !A$.
    
\begin{tabular}{rll}
1. & $\Gamma_0 \Proves \lnot !A$ & hyp \\
2. & $\lnot !A \lif (!A \lif !B) $ & Ax0\\
3. & $\Gamma_0 \Proves !A \lif !B$ & MP 1, 2\\
\end{tabular}

The proof for $\Gamma \Proves !B$ is similar:

\begin{tabular}{rll}
1. & $\Gamma_0 \Proves !B$ & hyp \\
2. & $!B \lif (!A \lif !B) $ & Ax0\\
3. & $\Gamma_0 \Proves !A \lif !B$ & MP 1, 2\\
\end{tabular}}}

\end{enumerate}
\end{proof}

\begin{probtag}{probOr,probAnd,probIf}
Complete the proof of \olref[fol][seq][prv]{prop:provability}.
\end{probtag}
%%End

\begin{thm}[Generalization] \ollabel{thm:Generalization}
  If $\Gamma \Proves !A$ and $x$ is not free
  in any !!{formula} in $\Gamma$, then $\Gamma \Proves \lforall[x][!A]$.
\end{thm}

\begin{proof}
  By induction on $\mathsf{Thm}_\Gamma$: if $!A$ is an axiom, so
  is $\lforall[x][!A]$. If $!A\in \Gamma$ then $x$ is not free
  in $!A$, so that $!A \lif \lforall[x][!A]$ is an
  axiom (\textbf{Ax3}), and $\Gamma \Proves \lforall[x][!A]$ by
  MP. Now suppose $!A$ follows by MP because $\Gamma \Proves !B$
  and $\Gamma \Proves !B \lif !A$. By induction hypothesis,
  $\Gamma \Proves \lforall[x][!B]$ and $\Gamma \Proves \lforall[x][( !B
  \lif !A)]$. But by \textbf{Ax2} also
  \[
  \Gamma \Proves \lforall[x][( !B \lif !A)] \lif (\lforall[x][
  !B] \lif \lforall[x][!A]),
  \]
and two applications of MP give $\Gamma \Proves \lforall[x][!A]$ as
desired.
\end{proof}

\begin{thm}\ollabel{thm:WeakGen}
  (\emph{Weak Generalization on Constants}) If $\Gamma \Proves !A$
  and $c$ is a !!{constant} not in occurring in $\Gamma$, then there is a
variable $x$ not in $!A$ such that $\Gamma \Proves
\lforall[x][\Subst{!A}{x}{c}]$, and the proof does not involve $c$.
\end{thm}

\begin{proof}
  Let $!A_1,\ldots,!A_n$ be a proof of $!A$ from
  $\Gamma$, so that $!A=!A_n$. Pick a variable $x$ not in
  $!A_1,\ldots,!A_n$, and consider the new sequence:
  $\Subst{!A_1}{x}{c},\ldots,\Subst{!A_n}{x}{c}.$
  Such a sequence is a proof of $\Subst{!A}{x}{c}$ from
  $\Gamma$. In fact, for each $i=1,\ldots,n$:
  \begin{itemize}
  \item if $!A$ is an axiom, then so is $\Subst{!A_i}{x}{c}$;
  \item if $!A_i \in \Gamma$, then since $c$ is not in $\Gamma$,
    we have $\Subst{!A_i}{x}{c} = !A_i \in \Gamma$;
  \item if $!A_i$ is obtained from $!A_j$ and $!A_j
    \lif !A_i$ then $\Subst{!A_i}{x}{c}$ follows by MP
    from  $\Subst{!A_j}{x}{c}$ and $\Subst{(!A_j
    \lif !A_i)}{x}{c} = \Subst{!A_j}{x}{c}
    \lif \Subst{!A_i}{x}{c}$. 
  \end{itemize}
  It is clear that the !!{constant} $c$ no longer occurs in the new
  sequence.  Now let $\Gamma'$ comprise those !!{formula}s from $\Gamma$
  that appear in the !!{derivation} of $\Subst{!A}{x}{c}$; then $x$ is
not free in any !!{formula} in $\Gamma'$ and $\Gamma' \Proves
\Subst{!A}{x}{c}$. By generalization (Theorem
\olref{thm:Generalization}) $\Gamma' \Proves
\lforall[x][\Subst{!A}{x}{c}]$, whence by monotony $\Gamma \Proves
\lforall[x][\Subst{!A}{x}{c}]$, as desired.
\end{proof}

Our goal is to replace the requirement in Theorem \olref{thm:WeakGen}
that $x$ does not occur in $!A$ (at all) by the weaker
requirements that $x$ is not free in $!A$ and it is !!{free for} $c$
in $!A$. Clearly this can be accomplished by a change of bound
!!{variable} --- so that is what we set out to prove first. 

\begin{lem}\ollabel{lem:8.19}
  If $x$ is free for $c$ in $!A$ and $y$ is not free in
  $!A$, then $x$ is !!{free for} $y$ in $\Subst{!A}{y}{c}$.
\end{lem}

\begin{proof}
  If $x$ is not !!{free for} $y$ in $\Subst{!A}{y}{x}$, then some
  free occurrence of $y$ in $\Subst{!A}{y}{c}$ falls within the
  scope of a quantifier $\lforall[x]$. But $y$ is not free in $!A$,
  by hypothesis, so all such occurrences come from the substitution
  $\Subst{}{y}{c}$. So some occurrence of $c$ falls within the scope
  of $\lforall[x]$ and $x$ is not !!{free for} $c$ in $!A$. 
\end{proof}

\begin{lem}\ollabel{lem:ChangeBdVar}
 (\emph{Change of Bound Variable}) If $x$ and $y$ are not
  free in $!A$ and they are both !!{free for} $c$ in $!A$, then
$\Proves \lforall[x][\Subst{!A}{x}{c}] \equiv
\lforall[y][\Subst{!A}{y}{c}]$ (and the proof does not involve $c$).
\end{lem}

\begin{proof}
  From the hypotheses, $y$ is !!{free for} $c$ in $!A$ and $x$ is not
  free in $!A$, so by the previous lemma \olref{lemma:8.19}, $y$ is
!!{free for} $x$ in $\Subst{!A}{x}{c}$. It follows that
$\lforall[x][\Subst{!A}{x}{c} \lif \Subst{!A}{x}{c}
  \Subst{}{y}{x}]$ is an axiom (\textbf{Ax1}). Since $x$ is not free
  in $!A$, we have $\Subst{!A}{x}{c} \Subst{}{y}{x} =
  \Subst{!A}{y}{c}$, so that 
  \[
  \Proves \lforall[x][\Subst{!A}{x}{c}] \lif
  \Subst{!A}{y}{c}, 
  \]
  and by the Deduction Theorem $\lforall[x][\Subst{!A}{x}{c}] \Proves
  \Subst{!A}{y}{c}$. Since $y$ is not free in $!A$, it also
  not free in $\lforall[x][\Subst{!A}{x}{c}]$, so that by
Generalization $\lforall[x][\Subst{!A}{x}{c}] \Proves
\lforall[y][\Subst{!A}{y}{c}]$, and the Deduction Theorem again gives
$\Proves \lforall[x][\Subst{!A}{x}{c}] \lif \lforall[y][\Subst{!A}{y}{c}]$.
  The proof of $\Proves \lforall[y][\Subst{!A}{y}{c}] \lif \lforall[x]
  [\Subst{!A}{x}{c}]$ is perfectly symmetric, so that the
  conclusion follows by Proposition T.
\end{proof}

\begin{thm}\ollabel{thm:StrongGen}
  (\emph{Strong Generalization on Constants}) If $\Gamma \Proves
  !A$, the !!{constant} $c$ does not occur in $\Gamma$, and $x$ is
  not free in $!A$ but it is !!{free for} $c$ in $!A$, then
  $\Gamma \Proves \lforall[x][\Subst{!A}{x}{c}]$.
\end{thm}

\begin{proof}
  Since $\Gamma \Proves !A$ and $c$ is not in $\Gamma$, then by
  Weak Generalization there is !!a{variable} $y$ not in $!A$ such
  that $\Gamma \Proves \lforall[y][\Subst{!A}{y}{c}]$. Since $y$ is not
  in $!A$ (at all), it is not free in $!A$ and it is also
  !!{free for} $c$ in $!A$; if moreover (by hypothesis) $x$ is not
  free in $!A$ and !!{free for} $c$ in $!A$, then the
  requirements for a change of bound !!{variable} are met, so $\Proves
  \lforall[x][\Subst{!A}{x}{c}] \equiv \lforall[y][\Subst{!A}{y}{c}]$,
  whence $\Gamma \Proves \lforall[x][\Subst{!A}{x}{c}]$.
\end{proof}

%%Taken from Sequent Calculus Chapter - edit
\begin{thm}
\ollabel{thm:provability-quantifiers}
\begin{tagenumerate}{prvEx,prvAll}
\tagitem{prvEx}{If $\Gamma \Proves !A(t)$ then $\Gamma \Proves
  \lexists[x][!A(x)]$.}{}

\tagitem{prvAll}{If $\Gamma \Proves \lforall[x][!A(x)]$ then $\Gamma \Proves
  !A(t)$.}{}
\end{tagenumerate}
\end{thm}

\begin{proof}
\begin{tagenumerate}{prvEx,prvAll}
\tagitem{prvEx}{Suppose $\Gamma \Proves !A(t)$. Then for some
  finite~$\Gamma_0 \subseteq \Gamma$, $\Log{LK}$ !!{derive}s $\Gamma_0
  \Sequent !A(t)$. Add an $\lexists$ right inference to get
  !!a{derivation} of $\Gamma_0 \Sequent \lexists[x][!A(x)]$.}{}

\tagitem{prvAll}{Suppose $\Gamma \Proves \lnot !A(t)$. Then there is a
  finite $\Gamma_0 \subseteq \Gamma$ and an $\Log{LK}$-!!{derivation}
  $\Pi$ of $\Gamma_0 \Sequent \lforall[x][!A(x)]$.  Then
% for some reason, prooftree env sometimes doesn't work here
% \begin{prooftree}
\[
\AxiomC{}
\RightLabel{$\Pi$}
\Deduce$\Gamma_0 \fCenter \lforall[x][!A(x)]$
\Axiom$!A(t) \fCenter !A(t)$
\RightLabel{$\lforall$ left}
\UnaryInf$\lforall[x][!A(x)] \fCenter !A(t)$
\RightLabel{cut}
\BinaryInf$\Gamma_0 \fCenter  !A(t)$
%\end{prooftree}
\DisplayProof
\]
shows that $\Gamma_0 \Proves !A(t)$.}{}
%%end

\end{tagenumerate}
\end{proof}

\end{document}