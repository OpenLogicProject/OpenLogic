% Part: first-order-logic 
% Chapter: axiomatic-proofs 
% Section: soundness-completeness-pred

\documentclass[../../include/open-logic-section]{subfiles}

\begin{document}

\olfileid{fol}{axp}{prs}

\olsection{Soundness and Completeness of Predicate Logic}

\begin{prop}
  If $!A$ is an axiom of predicate logic, then $\Struct{A}
  \Entails !A[s]$ for each !!{structure} $\Struct{A}$ and assignment
  $s$.
\end{prop}

\begin{proof}
  We first verify that the schemas \textbf{Ax0}--\textbf{Ax5} are
  valid. For instance, here is the case for \textbf{Ax1}: suppose $t$
is free for $x$ in $!A$, and assume $\Sat{A}{\lforall[x][!A]}[s]$. Then by
definition of satisfaction, for each
  $a \in A$, also $\Sat{A}{!A\Subst{s}{a}{x}}$, and in
particular this holds when $a = \overline s(t)$, i.e.,
$\Sat{A}{!A\Subst{s}{\overline s(t)}{x}}$. By the Substitution Theorem,
  $\Sat{A}{\Subst{!A}{t}{x}}[s]$. This shows that
$\Sat{A}{(\lforall[x][!A] \lif \Subst{!A}{t}{x})}[s]$. After verifying the
schemas, we see that
  their universal closures are also valid, by Corollary
  \ref{cor:valid}.
\end{proof}

\begin{thm} \ollabel{thm:Soundness}
  (\emph{Soundness}) If $\Gamma \Proves !A$ then $\Gamma \Entails
  !A$. 
\end{thm}

\begin{proof}
  By induction on theorems. By the previous proposition, all the
  axioms are valid, and hence if $!A$ is an axiom then $\Gamma
  \Entails !A$. Similarly if $!A \in \Gamma$. And if $\Gamma
  \Proves !B$ and $\Gamma \Proves !B \lif !A$ then $\Gamma
  \Entails !A$.
\end{proof}

\begin{thm} \ollabel{thm:Completeness}
  (\emph{Completeness}) If $\Gamma \Entails !A$ then $\Gamma
  \Proves !A$.
\end{thm}

This follows as a corollary, in the usual way, from the Theorem that
if $\Gamma$ is consistent then $\Gamma$ is satisfiable (Theorem
\olref{thm:Consis} below). Some more work is need to before we can give
the proof. In particular, in order to prove the theorem, assuming that
$\Gamma$ is satisfiable, we will build a !!{structure} $\Struct{A}$
and an assignment $s$ satisfying $\Gamma$. In so doing we need to
extend $\Gamma$ to a \emph{maximally consistent} set $\Delta$, in such
a way that if a !!{formula} $\lexists[x][!A]$ is in the set,
$\Subst{!A}{t}{x}$ is also in the set for some $t$. This is arranged
by making sure that the maximally consistent set $\Delta$ extending
$\Gamma$ contains all !!{formula}s $\lexists[x][!A] \lif
\Subst{!A}{t}{x}$ for some appropriate \emph{witness} $t$.

\begin{lem}\ollabel{lem:Constants}
  If $\Gamma$ is consistent in  $\Lang L$ and  $\Lang L'$ is
  obtained from  $\Lang L$ by adding countably many new !!{constants}
  $c_0, c_1, \ldots$, then $\Gamma$ is consistent in  $\Lang L'$.
\end{lem}

\begin{proof}
  Let $\Lang L'$ be obtained by expanding $\Lang L$ as
  described.  If $\Gamma$ is consistent in $\Lang L$ but not
  consistent in $\Lang L'$, then for some !!{formula}
  $!C(c_1,\ldots,c_n) \in \Lang L' $ both $\Gamma \Proves
  !C$ and $\Gamma \Proves \lnot !C$. By hypothesis the
  finitely many new constants $c_1,\ldots,c_n$ occurring in $!C$
  do not occur in $\Gamma$. By strong generalization on constants
  there are variables $x_1,\ldots,x_n$ not in $!C$ such that the
  following are provable in $\Lang L$:
  \begin{align*}
& \Gamma \Proves \lforall[x_1]\ldots
\lforall[x_n][\Subst{!C}{x_1}{c_1},\ldots,\Subst{}{x_n}{c_n}], \\
& \Gamma \Proves \lforall[x_1]\ldots \lforall[x_n][\lnot
\Subst{!C}{x_1}{c_1},\ldots,\Subst{}{x_n}{c_n}].
  \end{align*}
Since in particular the !!{variable}s $x_1,\ldots,x_n$ are !!{free for}
thecorresponding !!{constant}s $c_1,\ldots,c_n$, by \textbf{Ax1} also
\begin{align*}
   & \Gamma \Proves \Subst{!C}{x_1}{c_1},\ldots,\Subst{}{x_n}{c_n}, \\
    & \Gamma \Proves \lnot \Subst{!C}{x_1}{c_1},\ldots,\Subst{}{x_n}{c_n},
  \end{align*}
and $\Gamma$ is inconsistent.
\end{proof}

\begin{defn}
  A set $\Delta$ of !!{formula}s of a language $\Lang L$ is
  \emph{saturated} if and only if for each !!{formula} $!A \in
  \Lang L$ and !!{variable} $x$ there is a !!{constant} $c$ such that
  $\lnot \lforall[x][!A] \lif \lnot \Subst{!A}{c}{x}$ is in
  $\Delta$.
\end{defn}

\begin{defn}\label{def:Theta}
  Fix an enumeration $\tuple{!A_0, x_0},\tuple{!A_1,
  x_1},\ldots$ of all !!{formula}-!!{variable} pairs of $\Lang L'$,
  and define the !!{sentence} $!C_n$ by recursion on $n$. For
  $!C_0$ let $c_0$ be the first new !!{constant} that does not occur
  in $!A_0$ and let $!C_0$ be the !!{formula} $\lnot \lforall [x_0]
  [!A_0 \lif \lnot \Subst{!A_0}{c_0}{x_0}]$. Assuming
  $!C_0,\ldots!C_n$ have been defined, denote by $c_{n+1}$ the
  first new !!{constant} not occurring in $!C_0,\ldots!C_n$, and
  let $!C_{n+1}$ be the !!{formula}: $\lnot \lforall[x_{n+1}]
  [!A_{n+1}] \lif \lnot
  \Subst{!A_{n+1}}{c_{n+1}}{x_{n+1}}$. Finally, put $!C =
  \{!C_n : n \ge 0 \}$.
\end{defn}


\begin{prop}\ollabel{propSsaturation}[Saturation]
  Every consistent set $\Gamma$ can be extended to a saturated
  consistent set.
\end{prop}

\begin{proof}
Given a consistent $\Gamma$, expand the language by adding !!{enumerably}
many new !!{constant}s. By Lemma \olref{lem:Constants}, $\Gamma$ is
  still consistent in the richer language. Further, let $!C$ be as
  in Definition \ref{def:Theta}; then $\Gamma \cup !C$ is
  saturated by construction. To show that it is also consistent it
  suffices to show, by induction on $n$, that each set of the form
  $\Gamma \cup \{!C_0,\ldots!C_n \}$ is consistent.

  For the basis of the induction, suppose that $\Gamma \cup \{!C_0
  \}$ is inconsistent. It follows by Proposition \ref{prop:Proves}
  that $\Gamma \Proves \lnot !C_0$, whence both the following hold
  by Proposition T:
  \begin{align*}
    \Gamma & \Proves \lnot \lforall[x_0][!A_0], & \Gamma & \Proves
    \Subst{!A}{c_0}{x_0}.
  \end{align*}
  But $c_0$ does not occur in $\Gamma$ and the !!{variable} $x_0$ is not
  free in $\Subst{!A}{c_0}{x_0}$. Moreover, $x_0$ is !!{free for} $c_0$
  in $\Subst{!A}{c_0}{x_0}$ (since by choice of $c_0$ the only
  occurrences of $c_0$ in $\Subst{!A}{c_0}{x_0}$ !!{derive} from the
  substitution $\Subst{}{c_0}{x_0}$ and therefore fall outside the scope
  of any quantifier binding $x_0$). By Strong Generalization on
!!{Constants}, from the latter of these we obtain $\Gamma \Proves \lforall
[x_0][\Subst{!A_0}{c_0}{x_0}] \Subst{}{x_0}{c_0}$, i.e., $\Gamma \Proves
  \lforall[x_0][!A_0]$, and $\Gamma$ itself is inconsistent. The
  inductive step is perfectly analogous.
\end{proof}

\begin{prop}\label{prop:maximal}
  Every consistent set $\Gamma$ can be extended to a maximally
  consistent saturated set $\Gamma^*$.
\end{prop}


\begin{proof} Let $\Gamma$ be consistent, and $!C$ as in
  Definition \ref{def:Theta}. By proposition \ref{prop:saturation},
  $\Gamma \cup !C$ is a consistent saturated set in the richer
  language with the !!{enumerably} many new !!{constant}s.  We define
  $\Gamma^*$ exactly as in propositional logic: let $!A_0,
  !A_1,\ldots$ be an enumeration of all the !!{formula}s of
  $\Lang L'$. Define $\Gamma_0 = \Gamma \cup !C$ and
  \[
 \Gamma_{n+1} = 
    \begin{cases}
      \Gamma_n\cup\{!A_n\} & \text{if $ \Gamma_n\cup\{!A_n\}$
        is consistent;}\\
      \Gamma_n\cup\{\lnot!A_n\} & \text{otherwise}.
    \end{cases}
  \]
  Putting $\Gamma^* = \bigcup_{n\ge 0}\Gamma_n$, we obtain a maximally
  consistent set in $\Lang L'$; since $\Gamma \cup !C$ is
  saturated, so is $\Gamma^*$.
\end{proof}

Our plan is to extract from $\Gamma^*$ !!a{structure} $\Struct{A}'$
satisfying $\Gamma^*$ in $\Lang L'$, which can then be turned into
!!a{structure} $\Struct{A}$ satisfying $\Gamma$ in $\Lang L$ simply
by ``forgetting'' the interpretation of the new !!{constant}s
$c_n$. However, if the universe $A$ of $\Struct{A}'$ is simply taken
to be the set of all closed terms, this leads to a problem, in that we
might have $\Gamma^* \Proves t_1 \doteq t_2$ for \emph{distinct} terms
$t_1$ and $t_2$. This motivates the following definition of an
equivalence relation and the corresponding detour through the
resulting quotient.

\begin{defn}
  Define a relation $\approx$ over the set of terms of $\Lang L'$
  by setting $t \approx t'$ if and only $\Gamma^* \Proves t \doteq
  t'$. 
\end{defn}

\begin{defn}
  The relation $\approx$ is an equivalence over the terms of
  $\Lang L'$.
\end{defn}

\begin{proof}
  Reflexivity is given by Proposition \olref{prop:iden1}; symmetry and
  transitivity follow, in a similar way to Proposition
  \olref{prop:iden2}. For instance, symmetry: by \textbf{Ax5} and
  \textbf{Ax1}, $\Gamma^* \Proves t \doteq t' \lif (t \doteq t
  \lif t' \doteq t)$, so that if $t \approx t'$ then $\Gamma \Proves
  t \doteq t'$; but also $\Gamma \Proves t \doteq t$, as we just saw,
  so $\Gamma^* \Proves t' \doteq t$, i.e., $t'\approx t$. 
\end{proof}

\begin{defn}
  For each term $t$ of $\Lang L'$, the equivalence class $\{ t' :
  t \approx t' \}$ of $t$ relative to $\approx$ is denoted by $[t]$.
\end{defn}

We are now ready to complete the proof of the main theorem. 

\begin{thm}\ollabel{thm:consis}
  If $\Gamma$ is consistent then $\Gamma$ is satisfiable. 
\end{thm}

\begin{proof}
  Given a consistent $\Gamma$, we extend it to a maximally consistent
  saturated set $\Gamma^*$ of !!{formula}s of $\Lang L'$, using
  Proposition \olref{prop:maximal}. We define !!a{structure}
  $\Struct{A}'$ for $\Lang L'$ and an assignment $s$ as follows:
  \begin{itemize}
  \item $\Domain{A}' = A = \{ [t] : t \in \Lang L'\}$;
  \item $c^{\Struct{A}'} = [c]$ for each !!{constant} $c$ of $\Lang L'$.
  \item $\langle [t_1],\ldots,[t_n]\rangle \in P^{\Struct{A}'}$ if
    and only if $\Gamma^* \Proves Pt_1\ldots t_n$, for each $n$-place
    !!{predicate} $P$;
  \item $f^{\Struct{A}'}([t_1],\ldots,[t_n]) = [ft_1\ldots t_n]$,
    for each $n$-place !!{function} $f$;
  \item $s(x) = [x]$.
 \end{itemize}
 It is important to notice that the definitions of $P^{\Struct{A}'}$
 and $f^{\Struct{A}'}$ are ``independent of the representatives,''
 since the relation $\approx$ is a congruence with respect to
 $P^{\Struct{A}'}$ and $f^{\Struct{A}'}$. For instance, if $t
 \approx t'$ then $\Gamma^* \Proves t \doteq t'$ whence also $\Gamma^*
 \Proves ft_1\ldots t\ldots t_n \doteq ft_1\ldots t'\ldots t_n$ so that
 $ft_1\ldots t\ldots t_n \approx ft_1\ldots t'\ldots t_n$. It follows
 that $f^{\Struct{A}'}([t_1],\ldots,[t],\ldots,[t_n]) =
 f^{\Struct{A}'}([t_1],\ldots,[t'],\ldots,[t_n])$ and the definition
 is independent of the representative.

Next, one easily shows that for each therm $t$, $\overline s(t) = [t]$ (by
induction on $t$). Similarly, we prove that $\Struct{A}' \Entails
 !A[s]$ if and only if $!A \in \Gamma^*$, whence in
 particular $s$ satisfies $\Gamma^*$. The proof that $\Struct{A}'
 \Entails !A[s]$ if and only if $!A \in \Gamma^*$ is by
 induction on $!A$, the crucial case being the one for the
 universal quantifier:
 \begin{itemize}
 \item If $\Sat/{A'}{!B}[s]$, then for some term $t$,
   $\Sat/{A'}{!B}[\Subst{s}{[t]}{x}]$, i.e.,
   $\Sat/{A}'{!B}[\Subst{s}{\overline{s}(t)}{x}]$. Using Lemma
   \olref{lem:ChangeBdVar} (Change of Bound Variable), successively
   rename each quantifier $\lforall[y]$ in $!B$ as needed to obtain a
   !!{formula} $!B'$ such that $t$ is !!{free for} $x$ in $!B'$ and
$\Proves !B \equiv !B'$. It follows that
$\Sat/{A'}{!B'}[\Subst{s}{\overline{s}(t)}{x})]$, and by the Substitution
Theorem (theorem \olref{thm:SubstThm}), also
$\Sat/{A'}{\Subst{!B'}{t}{x}}[s]$. By the inductive hypothesis,
   $\Subst{!B'}{t}{x} \notin \Gamma^*$, whence $\lforall[x][!B']
   \notin \Gamma^*$. But by deductive closure and $\Proves !B \equiv
   !B'$, we have $\lforall[x][!B] \notin \Gamma^*$.
 \item If $\lforall[x][!B] \notin \Gamma^*$, then by maximality $\lnot
   \lforall[x][!B] \in \Gamma^*$, and by saturation for some $c$, also
   $\lnot \Subst{!B}{c}{x} \in \Gamma^*$, so that by consistency
   $\Subst{!B}{c}{x} \notin \Gamma^*$. By the inductive hypothesis,
   $\Sat/{A'}{\Subst{!B}{c}{x}}[s]$, so that
   $\Sat/{A'}{\Subst{!B}{\overline{s}(c)}}{x}$ by the
Substitution Theorem. The conclusion $\Sat/{A'}{\lforall[x][!B]}[s]$
follows.
\end{itemize}


Finally, let $\Struct{A}$ be the !!{structure} for $\Lang L$
obtained from $\Struct{A}'$ by dropping the interpretations of the
new !!{constant}s $c_n$. Using induction of !!{formula}s $!A$ of
$\Lang L$ one can show that $\Sat{A'}{!A}[s]$ if
and only if  $\Sat{A}{!A}[s]$, so that $s$ satisfies
$\Gamma$ in $\Struct{A}$.
\end{proof}

\begin{defn}
  A set $\Gamma$ of !!{formula}s is \emph{finitely satisfiable} if and
  only if every finite $\Gamma_0 \subseteq \Gamma$ is satisfiable.
\end{defn}

\begin{cor} \ollabel{cor:compact} (\emph{Compactness Theorem})
\begin{enumerate}
  \item if $\Gamma \Entails !A$ then there is a finite $\Gamma_0
    \subseteq \Gamma$ such that $\Gamma_0 \Entails !A$;
  \item $\Gamma$ is satisfiable if and only if it is finitely
    satisfiable. 
\end{enumerate}
\end{cor}

\end{document}